(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}})();const we="modulepreload",ye=function(s){return"/"+s},te={},ae=function(e,t,i){if(!t||t.length===0)return e();const n=document.getElementsByTagName("link");return Promise.all(t.map(o=>{if(o=ye(o),o in te)return;te[o]=!0;const c=o.endsWith(".css"),r=c?'[rel="stylesheet"]':"";if(!!i)for(let d=n.length-1;d>=0;d--){const f=n[d];if(f.href===o&&(!c||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${r}`))return;const l=document.createElement("link");if(l.rel=c?"stylesheet":we,c||(l.as="script",l.crossOrigin=""),l.href=o,document.head.appendChild(l),c)return new Promise((d,f)=>{l.addEventListener("load",d),l.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>e()).catch(o=>{const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o})};/*! Capacitor: https://capacitorjs.com/ - MIT License */const Le=s=>{const e=new Map;e.set("web",{name:"web"});const t=s.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:e},i=(o,c)=>{t.platforms.set(o,c)},n=o=>{t.platforms.has(o)&&(t.currentPlatform=t.platforms.get(o))};return t.addPlatform=i,t.setPlatform=n,t},xe=s=>s.CapacitorPlatforms=Le(s),ce=xe(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});ce.addPlatform;ce.setPlatform;var R;(function(s){s.Unimplemented="UNIMPLEMENTED",s.Unavailable="UNAVAILABLE"})(R||(R={}));class Y extends Error{constructor(e,t,i){super(e),this.message=e,this.code=t,this.data=i}}const be=s=>{var e,t;return s!=null&&s.androidBridge?"android":!((t=(e=s==null?void 0:s.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},Pe=s=>{var e,t,i,n,o;const c=s.CapacitorCustomPlatform||null,r=s.Capacitor||{},a=r.Plugins=r.Plugins||{},l=s.CapacitorPlatforms,d=()=>c!==null?c.name:be(s),f=((e=l==null?void 0:l.currentPlatform)===null||e===void 0?void 0:e.getPlatform)||d,x=()=>f()!=="web",g=((t=l==null?void 0:l.currentPlatform)===null||t===void 0?void 0:t.isNativePlatform)||x,D=v=>{const m=q.get(v);return!!(m!=null&&m.platforms.has(f())||Q(v))},$=((i=l==null?void 0:l.currentPlatform)===null||i===void 0?void 0:i.isPluginAvailable)||D,U=v=>{var m;return(m=r.PluginHeaders)===null||m===void 0?void 0:m.find(O=>O.name===v)},Q=((n=l==null?void 0:l.currentPlatform)===null||n===void 0?void 0:n.getPluginHeader)||U,de=v=>s.console.error(v),ue=(v,m,O)=>Promise.reject(`${O} does not have an implementation of "${m}".`),q=new Map,fe=(v,m={})=>{const O=q.get(v);if(O)return console.warn(`Capacitor plugin "${v}" already registered. Cannot register plugins twice.`),O.proxy;const E=f(),k=Q(v);let b;const me=async()=>(!b&&E in m?b=typeof m[E]=="function"?b=await m[E]():b=m[E]:c!==null&&!b&&"web"in m&&(b=typeof m.web=="function"?b=await m.web():b=m.web),b),pe=(p,w)=>{var L,P;if(k){const C=k==null?void 0:k.methods.find(y=>w===y.name);if(C)return C.rtype==="promise"?y=>r.nativePromise(v,w.toString(),y):(y,G)=>r.nativeCallback(v,w.toString(),y,G);if(p)return(L=p[w])===null||L===void 0?void 0:L.bind(p)}else{if(p)return(P=p[w])===null||P===void 0?void 0:P.bind(p);throw new Y(`"${v}" plugin is not implemented on ${E}`,R.Unimplemented)}},F=p=>{let w;const L=(...P)=>{const C=me().then(y=>{const G=pe(y,p);if(G){const _=G(...P);return w=_==null?void 0:_.remove,_}else throw new Y(`"${v}.${p}()" is not implemented on ${E}`,R.Unimplemented)});return p==="addListener"&&(C.remove=async()=>w()),C};return L.toString=()=>`${p.toString()}() { [capacitor code] }`,Object.defineProperty(L,"name",{value:p,writable:!1,configurable:!1}),L},Z=F("addListener"),ee=F("removeListener"),ge=(p,w)=>{const L=Z({eventName:p},w),P=async()=>{const y=await L;ee({eventName:p,callbackId:y},w)},C=new Promise(y=>L.then(()=>y({remove:P})));return C.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await P()},C},z=new Proxy({},{get(p,w){switch(w){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return k?ge:Z;case"removeListener":return ee;default:return F(w)}}});return a[v]=z,q.set(v,{name:v,proxy:z,platforms:new Set([...Object.keys(m),...k?[E]:[]])}),z},ve=((o=l==null?void 0:l.currentPlatform)===null||o===void 0?void 0:o.registerPlugin)||fe;return r.convertFileSrc||(r.convertFileSrc=v=>v),r.getPlatform=f,r.handleError=de,r.isNativePlatform=g,r.isPluginAvailable=$,r.pluginMethodNoop=ue,r.registerPlugin=ve,r.Exception=Y,r.DEBUG=!!r.DEBUG,r.isLoggingEnabled=!!r.isLoggingEnabled,r.platform=r.getPlatform(),r.isNative=r.isNativePlatform(),r},Ce=s=>s.Capacitor=Pe(s),j=Ce(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),I=j.registerPlugin;j.Plugins;class le{constructor(e){this.listeners={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t);const n=this.windowListeners[e];n&&!n.registered&&this.addWindowListener(n);const o=async()=>this.removeListener(e,t),c=Promise.resolve({remove:o});return Object.defineProperty(c,"remove",{value:async()=>{console.warn("Using addListener() without 'await' is deprecated."),await o()}}),c}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t){const i=this.listeners[e];i&&i.forEach(n=>n(t))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:i=>{this.notifyListeners(t,i)}}}unimplemented(e="not implemented"){return new j.Exception(e,R.Unimplemented)}unavailable(e="not available"){return new j.Exception(e,R.Unavailable)}async removeListener(e,t){const i=this.listeners[e];if(!i)return;const n=i.indexOf(t);this.listeners[e].splice(n,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}}const se=s=>encodeURIComponent(s).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),ie=s=>s.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Se extends le{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(i=>{if(i.length<=0)return;let[n,o]=i.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");n=ie(n).trim(),o=ie(o).trim(),t[n]=o}),t}async setCookie(e){try{const t=se(e.key),i=se(e.value),n=`; expires=${(e.expires||"").replace("expires=","")}`,o=(e.path||"/").replace("path=",""),c=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${i||""}${n}; path=${o}; ${c};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}I("CapacitorCookies",{web:()=>new Se});const Ee=async s=>new Promise((e,t)=>{const i=new FileReader;i.onload=()=>{const n=i.result;e(n.indexOf(",")>=0?n.split(",")[1]:n)},i.onerror=n=>t(n),i.readAsDataURL(s)}),Oe=(s={})=>{const e=Object.keys(s);return Object.keys(s).map(n=>n.toLocaleLowerCase()).reduce((n,o,c)=>(n[o]=s[e[c]],n),{})},ke=(s,e=!0)=>s?Object.entries(s).reduce((i,n)=>{const[o,c]=n;let r,a;return Array.isArray(c)?(a="",c.forEach(l=>{r=e?encodeURIComponent(l):l,a+=`${o}=${r}&`}),a.slice(0,-1)):(r=e?encodeURIComponent(c):c,a=`${o}=${r}`),`${i}&${a}`},"").substr(1):null,Me=(s,e={})=>{const t=Object.assign({method:s.method||"GET",headers:s.headers},e),n=Oe(s.headers)["content-type"]||"";if(typeof s.data=="string")t.body=s.data;else if(n.includes("application/x-www-form-urlencoded")){const o=new URLSearchParams;for(const[c,r]of Object.entries(s.data||{}))o.set(c,r);t.body=o.toString()}else if(n.includes("multipart/form-data")||s.data instanceof FormData){const o=new FormData;if(s.data instanceof FormData)s.data.forEach((r,a)=>{o.append(a,r)});else for(const r of Object.keys(s.data))o.append(r,s.data[r]);t.body=o;const c=new Headers(t.headers);c.delete("content-type"),t.headers=c}else(n.includes("application/json")||typeof s.data=="object")&&(t.body=JSON.stringify(s.data));return t};class Ae extends le{async request(e){const t=Me(e,e.webFetchExtra),i=ke(e.params,e.shouldEncodeUrlParams),n=i?`${e.url}?${i}`:e.url,o=await fetch(n,t),c=o.headers.get("content-type")||"";let{responseType:r="text"}=o.ok?e:{};c.includes("application/json")&&(r="json");let a,l;switch(r){case"arraybuffer":case"blob":l=await o.blob(),a=await Ee(l);break;case"json":a=await o.json();break;case"document":case"text":default:a=await o.text()}const d={};return o.headers.forEach((f,x)=>{d[x]=f}),{data:a,headers:d,status:o.status,url:o.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}I("CapacitorHttp",{web:()=>new Ae});var B;(function(s){s.Heavy="HEAVY",s.Medium="MEDIUM",s.Light="LIGHT"})(B||(B={}));var re;(function(s){s.Success="SUCCESS",s.Warning="WARNING",s.Error="ERROR"})(re||(re={}));const N=I("Haptics",{web:()=>ae(()=>import("./web-37527e63.js"),[]).then(s=>new s.HapticsWeb)});var V;(function(s){s.Dark="DARK",s.Light="LIGHT",s.Default="DEFAULT"})(V||(V={}));var ne;(function(s){s.None="NONE",s.Slide="SLIDE",s.Fade="FADE"})(ne||(ne={}));const oe=I("StatusBar"),Te=I("App",{web:()=>ae(()=>import("./web-45550a0d.js"),[]).then(s=>new s.AppWeb)}),M={async init(){try{await oe.setStyle({style:V.Dark}),await oe.setBackgroundColor({color:"#0f172a"})}catch{console.log("Web environment")}},async vibrate(s="light"){try{s==="heavy"?await N.impact({style:B.Heavy}):s==="medium"?await N.impact({style:B.Medium}):await N.impact({style:B.Light})}catch{navigator.vibrate&&navigator.vibrate(s==="heavy"?40:15)}},onBack(s){Te.addListener("backButton",s)}};class Re{constructor(){this.ctx=null,this.enabled=!0}init(){if(!this.ctx){const e=window.AudioContext||window.webkitAudioContext;e&&(this.ctx=new e)}this.ctx&&this.ctx.state==="suspended"&&this.ctx.resume()}playTone(e,t,i,n=.1){if(!this.enabled||!this.ctx)return;const o=this.ctx.createOscillator(),c=this.ctx.createGain();o.type=t,o.frequency.setValueAtTime(e,this.ctx.currentTime),c.gain.setValueAtTime(n,this.ctx.currentTime),c.gain.exponentialRampToValueAtTime(.01,this.ctx.currentTime+i),o.connect(c),c.connect(this.ctx.destination),o.start(),o.stop(this.ctx.currentTime+i)}move(){this.playTone(300,"sine",.1,.05)}score(){this.playTone(600,"triangle",.1,.1),setTimeout(()=>this.playTone(800,"sine",.2,.1),100)}win(){[400,500,600,800].forEach((e,t)=>setTimeout(()=>this.playTone(e,"square",.2,.1),t*150))}}const h={X:1,O:0,COLORS:{lineActive:"#94a3b8",linePlayed:"#f8fafc",x:"#ef4444",o:"#3b82f6",xDim:"rgba(239, 68, 68, 0.15)",oDim:"rgba(59, 130, 246, 0.15)",lastMove:"#00ffcc",glow:"#00ffcc",bg:"#1e293b"}};class K{constructor(e){this.init(e)}init(e){this.R=Math.floor(e/2),e==4&&(this.R=2),e==6&&(this.R=3),e==8&&(this.R=4),this.S=2*this.R+1,this.C=this.R,this.D=this.S+1,this.h=Array(this.D).fill().map(()=>Array(this.S).fill(!1)),this.v=Array(this.S).fill().map(()=>Array(this.D).fill(!1)),this.owner=Array(this.S).fill().map(()=>Array(this.S).fill(null)),this.score=[0,0],this.setupPerimeter(),this.setupInitialCells()}active(e,t){return Math.abs(e-this.C)+Math.abs(t-this.C)<=this.R}setupPerimeter(){for(let e=0;e<this.D;e++)for(let t=0;t<this.S;t++){const i=e>0?this.active(e-1,t):!1,n=e<this.S?this.active(e,t):!1;i!==n&&(this.h[e][t]=!0)}for(let e=0;e<this.S;e++)for(let t=0;t<this.D;t++){const i=t>0?this.active(e,t-1):!1,n=t<this.S?this.active(e,t):!1;i!==n&&(this.v[e][t]=!0)}}setupInitialCells(){const e=this.C;[{r:0,c:e,p:h.X},{r:this.S-1,c:e,p:h.X},{r:e,c:0,p:h.O},{r:e,c:this.S-1,p:h.O}].forEach(({r:t,c:i,p:n})=>{this.active(t,i)&&(this.owner[t][i]=n,this.score[n]++,this.h[t][i]=this.h[t+1][i]=!0,this.v[t][i]=this.v[t][i+1]=!0)})}makeMove(e,t,i,n){if(e==="h"){if(this.h[t][i])return null;this.h[t][i]=!0}else{if(this.v[t][i])return null;this.v[t][i]=!0}let o=[];const c=(r,a)=>{this.active(r,a)&&this.owner[r][a]==null&&this.h[r][a]&&this.h[r+1][a]&&this.v[r][a]&&this.v[r][a+1]&&(this.owner[r][a]=n,this.score[n]++,o.push({r,c:a}))};return e==="h"?(t<this.S&&c(t,i),t>0&&c(t-1,i)):(i<this.S&&c(t,i),i>0&&c(t,i-1)),{points:o.length,capturedSquares:o}}isGameOver(){for(let e=0;e<this.D;e++)for(let t=0;t<this.S;t++)if(!this.h[e][t]&&this.active(e,t)&&this.active(e-1,t))return!1;for(let e=0;e<this.S;e++)for(let t=0;t<this.D;t++)if(!this.v[e][t]&&this.active(e,t)&&this.active(e,t-1))return!1;return!0}getFreeMoves(){let e=[];for(let t=0;t<this.D;t++)for(let i=0;i<this.S;i++)!this.h[t][i]&&this.active(t,i)&&this.active(t-1,i)&&e.push({t:"h",r:t,c:i});for(let t=0;t<this.S;t++)for(let i=0;i<this.D;i++)!this.v[t][i]&&this.active(t,i)&&this.active(t,i-1)&&e.push({t:"v",r:t,c:i});return e}clone(){const e=new K(4);return e.R=this.R,e.S=this.S,e.C=this.C,e.D=this.D,e.h=this.h.map(t=>[...t]),e.v=this.v.map(t=>[...t]),e.owner=this.owner.map(t=>[...t]),e.score=[...this.score],e}}const De={getBestMove(s,e){const t=s.getFreeMoves();if(t.length===0)return null;if(e!=="easy"){const i=t.find(n=>s.clone().makeMove(n.t,n.r,n.c,h.O).points>0);if(i)return i}if(e==="hard"){const i=t.filter(n=>{const o=s.clone();return o.makeMove(n.t,n.r,n.c,h.O),!o.getFreeMoves().some(a=>o.clone().makeMove(a.t,a.r,a.c,h.X).points>0)});if(i.length>0)return i[Math.floor(Math.random()*i.length)]}return t[Math.floor(Math.random()*t.length)]}};class Be{constructor(e){this.canvas=e,this.ctx=e.getContext("2d",{alpha:!1}),this.particles=[],this.CELL=0,this.offX=0,this.offY=0}resize(e,t){this.canvas.style.width="",this.canvas.style.height="";const i=window.innerWidth,n=window.innerHeight,o=40,r=i>800?220:140,a=i-o;let l=n-r;l<200&&(l=200);const d=Math.floor(Math.min(a,l)),f=window.devicePixelRatio||1;this.ctx.setTransform(1,0,0,1,0,0),this.canvas.width=d*f,this.canvas.height=d*f,this.canvas.style.width=`${d}px`,this.canvas.style.height=`${d}px`,this.ctx.scale(f,f),this.CELL=Math.floor(d/(t+1));const x=t*this.CELL;this.offX=(d-x)/2,this.offY=(d-x)/2}draw(e,t){this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.fillStyle=h.COLORS.bg,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.restore();const i=r=>this.offX+r*this.CELL,n=r=>this.offY+r*this.CELL;this.updateParticles();for(let r=0;r<e.S;r++)for(let a=0;a<e.S;a++)if(e.active(r,a)&&e.owner[r][a]!=null){const l=e.owner[r][a],d=this.CELL*.15;this.ctx.fillStyle=l===h.X?h.COLORS.xDim:h.COLORS.oDim,this.roundRect(i(a)+d,n(r)+d,this.CELL-d*2,this.CELL-d*2,8),this.ctx.fill(),this.ctx.fillStyle=l===h.X?h.COLORS.x:h.COLORS.o,this.ctx.font=`800 ${this.CELL*.5}px Montserrat`,this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(l===h.X?"X":"O",i(a)+this.CELL/2,n(r)+this.CELL/2+2)}const o=(r,a,l,d)=>{this.ctx.beginPath();const f=i(a),x=n(r),g=i(l==="h"?a+1:a),D=n(l==="h"?r:r+1);this.ctx.moveTo(f,x),this.ctx.lineTo(g,D),d?(this.ctx.strokeStyle=h.COLORS.lineActive,this.ctx.lineWidth=1,this.ctx.setLineDash([2,8]),this.ctx.stroke(),this.ctx.setLineDash([])):t&&t.t===l&&t.r===r&&t.c===a?(this.ctx.strokeStyle=h.COLORS.lastMove,this.ctx.lineWidth=4,this.ctx.lineCap="round",this.ctx.shadowBlur=15,this.ctx.shadowColor=h.COLORS.glow,this.ctx.stroke(),this.ctx.shadowBlur=0):(this.ctx.strokeStyle=h.COLORS.linePlayed,this.ctx.lineWidth=3,this.ctx.lineCap="round",this.ctx.stroke())};for(let r=0;r<e.D;r++)for(let a=0;a<e.S;a++)e.h[r][a]&&o(r,a,"h",!1);for(let r=0;r<e.S;r++)for(let a=0;a<e.D;a++)e.v[r][a]&&o(r,a,"v",!1);for(let r=0;r<e.D;r++)for(let a=0;a<e.S;a++)!e.h[r][a]&&e.active(r,a)&&e.active(r-1,a)&&o(r,a,"h",!0);for(let r=0;r<e.S;r++)for(let a=0;a<e.D;a++)!e.v[r][a]&&e.active(r,a)&&e.active(r,a-1)&&o(r,a,"v",!0);this.ctx.fillStyle="#64748b";const c=Math.max(3,this.CELL/12);for(let r=0;r<=e.S;r++)for(let a=0;a<=e.S;a++)(e.active(r,a)||e.active(r-1,a)||e.active(r,a-1)||e.active(r-1,a-1))&&(this.ctx.beginPath(),this.ctx.arc(i(a),n(r),c,0,Math.PI*2),this.ctx.fill())}spawnParticles(e,t,i){const n=l=>this.offX+l*this.CELL,o=l=>this.offY+l*this.CELL,c=n(t)+this.CELL/2,r=o(e)+this.CELL/2,a=i===h.X?h.COLORS.x:h.COLORS.o;for(let l=0;l<15;l++)this.particles.push({x:c,y:r,color:a,vx:(Math.random()-.5)*10,vy:(Math.random()-.5)*10,life:1,size:5})}updateParticles(){for(let e=this.particles.length-1;e>=0;e--){const t=this.particles[e];t.x+=t.vx,t.y+=t.vy,t.vx*=.9,t.vy*=.9,t.life-=.05,t.size*=.94,this.ctx.globalAlpha=t.life,this.ctx.fillStyle=t.color,this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.size,0,Math.PI*2),this.ctx.fill(),this.ctx.globalAlpha=1,t.life<=0&&this.particles.splice(e,1)}}roundRect(e,t,i,n,o){i<2*o&&(o=i/2),n<2*o&&(o=n/2),this.ctx.beginPath(),this.ctx.moveTo(e+o,t),this.ctx.arcTo(e+i,t,e+i,t+n,o),this.ctx.arcTo(e+i,t+n,e,t+n,o),this.ctx.arcTo(e,t+n,e,t,o),this.ctx.arcTo(e,t,e+i,t,o),this.ctx.closePath()}}const X=new Re,S={board:null,renderer:null,ui:null,player:h.X,settings:{size:6,mode:"ai",diff:"normal"},gameOver:!1,aiThinking:!1,lastMove:null,historyStack:[],init(s,e){this.ui=e,this.renderer=new Be(s),M.init(),window.addEventListener("resize",()=>{this.board&&this.renderer.resize(this.ui.viewGame,this.board.S)});const t=(i,n)=>this.processInput(i,n);s.addEventListener("mousedown",i=>t(i.clientX,i.clientY)),s.addEventListener("touchstart",i=>{i.preventDefault(),t(i.touches[0].clientX,i.touches[0].clientY)},{passive:!1})},start(s,e,t){X.init(),this.settings={size:s,mode:e,diff:t},document.getElementById("overlay").classList.remove("flex"),localStorage.removeItem("rhombus_save"),this.player=h.X,this.gameOver=!1,this.historyStack=[],this.lastMove=null,this.board=new K(s),this.renderer.particles=[],this.ui.viewMenu.classList.add("hidden"),this.ui.viewMenu.classList.remove("active-view"),this.ui.viewGame.classList.remove("hidden"),this.ui.viewGame.classList.add("active-view"),this.renderer.resize(this.ui.viewGame,this.board.S),this.updateUI(),requestAnimationFrame(()=>this.loop())},processInput(s,e){if(this.gameOver||this.aiThinking||this.settings.mode==="ai"&&this.player===h.O)return;const t=this.renderer.canvas.getBoundingClientRect(),i=this.renderer.canvas.width/t.width/(window.devicePixelRatio||1),n=this.renderer.canvas.height/t.height/(window.devicePixelRatio||1),o=(s-t.left)*i,c=(e-t.top)*n,r=g=>this.renderer.offX+g*this.renderer.CELL,a=g=>this.renderer.offY+g*this.renderer.CELL,l=this.renderer.CELL;let d=null,f=l*.6;this.board.getFreeMoves().forEach(g=>{const D=g.t==="h"?r(g.c)+l/2:r(g.c),$=g.t==="h"?a(g.r):a(g.r)+l/2,U=Math.hypot(o-D,c-$);U<f&&(f=U,d=g)}),d&&this.executeMove(d)},executeMove(s){this.historyStack.push({boardState:this.board.clone(),player:this.player,score:[...this.board.score]});const e=this.board.makeMove(s.t,s.r,s.c,this.player);if(e){if(this.lastMove=s,M.vibrate("light"),e.points>0?(X.score(),M.vibrate("medium"),e.capturedSquares.forEach(t=>{this.renderer.spawnParticles(t.r,t.c,this.player)})):(X.move(),this.player=1-this.player),this.saveLocal(),this.updateUI(),this.board.isGameOver()){setTimeout(()=>this.endGame(),500);return}if(this.settings.mode==="ai"&&this.player===h.O){const t=500+Math.random()*500;setTimeout(()=>this.runAI(),t)}}},runAI(){this.aiThinking=!0;const s=De.getBestMove(this.board,this.settings.diff);s&&this.executeMove(s),this.aiThinking=!1},undo(){if(this.historyStack.length===0||this.aiThinking)return;const s=this.historyStack.pop();this.board=s.boardState,this.player=s.player,this.board.score=s.score,this.updateUI(),this.saveLocal(),M.vibrate("light")},endGame(){this.gameOver=!0,X.win(),M.vibrate("heavy");const s=this.board.score;document.getElementById("result-title").textContent=s[h.X]>s[h.O]?"You Win!":s[h.O]>s[h.X]?"Game Over":"Draw",document.getElementById("result-score").textContent=`${s[h.X]} - ${s[h.O]}`,document.getElementById("overlay").classList.add("flex"),localStorage.removeItem("rhombus_save")},updateUI(){this.ui.p1Score.textContent=this.board.score[h.X],this.ui.p2Score.textContent=this.board.score[h.O],this.player===h.X?(this.ui.p1Card.classList.add("active"),this.ui.p2Card.classList.remove("active")):(this.ui.p1Card.classList.remove("active"),this.ui.p2Card.classList.add("active")),this.historyStack.length>0?this.ui.undoBtn.classList.remove("disabled"):this.ui.undoBtn.classList.add("disabled")},loop(){this.ui.viewGame.classList.contains("hidden")||(this.renderer.CELL<=0&&this.renderer.resize(this.ui.viewGame,this.board.S),this.renderer.draw(this.board,this.lastMove),(!this.gameOver||this.renderer.particles.length>0)&&requestAnimationFrame(()=>this.loop()))},saveLocal(){if(this.gameOver)return;const s={board:this.board,player:this.player,settings:this.settings,history:this.historyStack};localStorage.setItem("rhombus_save",JSON.stringify(s))}},u=s=>document.getElementById(s),A={viewMenu:u("view-menu"),viewGame:u("view-game"),p1Card:u("p1-card"),p2Card:u("p2-card"),p1Score:u("p1-score"),p2Score:u("p2-score"),undoBtn:u("undoBtn")};S.init(u("canvas"),A);const J=(s,e)=>{document.querySelectorAll(s).forEach(t=>t.onclick=()=>{document.querySelectorAll(s).forEach(i=>i.classList.remove("selected")),t.classList.add("selected"),e(t)})};let H=6,T="ai",W="normal";J("[data-size]",s=>H=+s.dataset.size);J("[data-ai]",s=>{T=s.dataset.ai,u("difficulty-wrapper").style.opacity=T==="pvp"?"0.3":"1",u("difficulty-wrapper").style.pointerEvents=T==="pvp"?"none":"auto"});J("[data-diff]",s=>W=s.dataset.diff);u("startBtn").onclick=()=>S.start(H,T,W);u("undoBtn").onclick=()=>S.undo();u("restartBtn").onclick=()=>S.start(H,T,W);u("menuBtn").onclick=()=>{A.viewGame.classList.add("hidden"),A.viewGame.classList.remove("active-view"),A.viewMenu.classList.remove("hidden"),A.viewMenu.classList.add("active-view"),S.gameOver=!0};u("againBtn").onclick=()=>{u("overlay").classList.remove("flex"),S.start(H,T,W)};u("backMenuBtn").onclick=()=>{u("overlay").classList.remove("flex"),u("menuBtn").click()};u("helpBtn").onclick=()=>u("help-modal").classList.add("flex");u("closeHelpBtn").onclick=()=>u("help-modal").classList.remove("flex");const he=u("canvas");he.addEventListener("mousedown",s=>S.handleInput(s.clientX,s.clientY));he.addEventListener("touchstart",s=>{s.preventDefault(),S.handleInput(s.touches[0].clientX,s.touches[0].clientY)},{passive:!1});M.onBack(({canGoBack:s})=>{A.viewGame.classList.contains("hidden")||u("menuBtn").click()});export{B as I,re as N,le as W};
